SELECT TOP 20
    ID,
    DatabaseName,
    StartTime,
    EndTime,
    DATEDIFF(MINUTE, StartTime, EndTime) AS DurationMinutes,
    DATEDIFF(SECOND, StartTime, EndTime) AS DurationSeconds,
    ErrorNumber,
    ErrorMessage,
    CASE 
        WHEN ErrorNumber IS NULL OR ErrorNumber = 0 THEN 'Success'
        WHEN ErrorNumber > 0 THEN 'Failed'
        ELSE 'Unknown'
    END AS Status
FROM dbo.CommandLog
WHERE CommandType = 'DBCC_CHECKDB'
ORDER BY StartTime DESC
